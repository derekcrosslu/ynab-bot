# Google Integration Setup (Gmail + Calendar + Maps)

Complete guide to set up Gmail, Calendar, and Google Maps for your WhatsApp travel assistant.

---

## Step 1: Create Google Cloud Project

1. Go to https://console.cloud.google.com/
2. Click **Create Project**
3. Name it: "WhatsApp Travel Assistant"
4. Click **Create**

---

## Step 2: Enable APIs

### Enable Gmail API:
1. Go to **APIs & Services** ‚Üí **Library**
2. Search for "Gmail API"
3. Click **Enable**

### Enable Calendar API:
1. In Library, search for "Google Calendar API"
2. Click **Enable**

### Enable Maps APIs:
1. Search for "Geocoding API" ‚Üí **Enable**
2. Search for "Places API" ‚Üí **Enable**
3. Search for "Distance Matrix API" ‚Üí **Enable**

---

## Step 3: Create OAuth Credentials (for Gmail + Calendar)

1. Go to **APIs & Services** ‚Üí **Credentials**
2. Click **Create Credentials** ‚Üí **OAuth client ID**
3. If prompted, configure **OAuth consent screen**:
   - User Type: **External**
   - App name: "WhatsApp Travel Assistant"
   - User support email: (your email)
   - Developer contact: (your email)
   - Scopes: Add these manually:
     * `.../auth/gmail.readonly`
     * `.../auth/gmail.send`
     * `.../auth/calendar`
   - Test users: Add your Gmail address
   - Click **Save and Continue**

4. Back to **Create OAuth client ID**:
   - Application type: **Desktop app**
   - Name: "WhatsApp Bot"
   - Click **Create**

5. **Download JSON**:
   - Click the download button (‚¨áÔ∏è)
   - Save as: `mcp-servers/google/credentials.json`

---

## Step 4: Create API Key (for Google Maps)

1. Still in **Credentials**, click **Create Credentials** ‚Üí **API key**
2. Copy the API key
3. (Optional) Click **Restrict Key**:
   - API restrictions: Select the 3 Maps APIs you enabled
   - Click **Save**

4. Add to `.env`:
```bash
GOOGLE_MAPS_API_KEY=your_api_key_here
```

---

## Step 5: Run OAuth Authentication

Once you have `credentials.json`:

```bash
cd mcp-servers/google
node auth.js
```

This will:
1. Open a browser for Google login
2. Ask you to authorize the app
3. Save the token to `token.json`

**Important:** Keep both files safe:
- `credentials.json` - OAuth client credentials
- `token.json` - Your personal access token

---

## Step 6: Verify Setup

Test that everything works:

```bash
node test.js
```

This will test:
- ‚úÖ Gmail API (search recent emails)
- ‚úÖ Calendar API (list upcoming events)
- ‚úÖ Maps API (geocode an address)

---

## File Structure

```
mcp-servers/google/
‚îú‚îÄ‚îÄ credentials.json  (OAuth client - from Google Cloud Console)
‚îú‚îÄ‚îÄ token.json        (Your access token - generated by auth.js)
‚îú‚îÄ‚îÄ server.js         (Google MCP server)
‚îú‚îÄ‚îÄ auth.js           (OAuth flow script)
‚îú‚îÄ‚îÄ test.js           (Test all APIs)
‚îî‚îÄ‚îÄ SETUP.md          (This file)
```

---

## Adding to .env

```bash
# Google APIs
GOOGLE_CREDENTIALS_PATH=./mcp-servers/google/credentials.json
GOOGLE_TOKEN_PATH=./mcp-servers/google/token.json
GOOGLE_MAPS_API_KEY=your_maps_api_key_here
```

---

## Troubleshooting

**Error: "Access blocked: This app's request is invalid"**
- Make sure you added your email to "Test users" in OAuth consent screen

**Error: "The caller does not have permission"**
- Check that you enabled the Gmail/Calendar/Maps APIs

**Error: "Invalid credentials"**
- Make sure `credentials.json` is in the right location
- Re-download from Google Cloud Console if needed

**Token expired:**
- Delete `token.json`
- Run `node auth.js` again to re-authenticate

---

## Security Notes

**For Personal Use Only:**
- These credentials are for YOUR Google account only
- Don't commit `credentials.json` or `token.json` to git
- Already in `.gitignore` for safety

**Scopes Explained:**
- `gmail.readonly` - Read emails (for booking confirmations)
- `gmail.send` - Send emails (for notifications)
- `calendar` - Create/read calendar events

---

## Next Steps

After setup complete:
1. ‚úÖ Bot will auto-add flight/hotel bookings to your Calendar
2. ‚úÖ Bot can monitor Gmail for booking confirmations
3. ‚úÖ Bot uses Maps to show distances, geocode addresses

**Ready to test!** üöÄ
